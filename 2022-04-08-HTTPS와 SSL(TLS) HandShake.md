---
aliases: []
categories: [μ΅°κ°κΈ€]
date-created: April 8, 2022 3:19 PM
tags:
  - Web
date-updated: 2023-02-27 05:54
---
<br><br>
# HTTPS

- β€Sβ€: Over Secure Socket Layer
- λ„λ©”μΈμ— λ€ν• μ†μ κ¶μ„ μΈμ¦ν•¨.
- λ°μ΄ν„°κ°€ μ•”νΈν™”λ¨
- μ  3 μμ— μν•΄ λ³€μ΅°, κ°μ²­λ  μ μ—†λ„λ΅ ν•¨.
<br><br>
## SSL(TLS)

- TCP ν†µμ‹ μ—μ„ λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•λ” ν”„λ΅ν† μ½.
- HTTP κ°€ SSL μ„ μ‚¬μ©ν•λ©΄ HTTPS μ΄λ‹¤. (HTTP over TLS)

### SSL λ””μ§€ν„Έ μΈμ¦μ„

- ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°„ ν†µμ‹ μ„ μ  3 μκ°€ λ³΄μ¦ν•΄μ£Όλ” μ „μν™”λ λ¬Έμ„
- μ ‘μ†ν•λ ¤λ” μ›Ή μ„λ²„κ°€ μ§„μ§ κ·Έ μ„λ²„κ°€ λ§λ”κ°€? λ¥Ό λ³΄μ¦
- ν†µμ‹  λ‚΄μ©μ΄ κ³µκ²©μμ—κ² λ…Έμ¶λλ” κ²ƒμ„ λ§‰μ„ μ μλ‹¤.
	- ν†µμ‹  λ‚΄μ©μ„ μ•”νΈν™” ν•λ‹¤. β†’ μ•”νΈν™”
	- λ, ν†µμ‹  λ‚΄μ©μ„ λ°›λ” μ½μ€ κ·Έ λ‚΄μ©μ„ μ΄ν•΄ν•  μ μλ„λ΅ ν•΄μ¤. β†’ λ³µνΈν™”
	- λ³µνΈν™” ν•κΈ° μ„ν•΄μ„λ” Key κ°€ ν•„μ”ν•λ‹¤.

[2022-04-09-Open SSL μ„¤μΉ](2022-04-09-Open%20SSL%20μ„¤μΉ.md)
<br><br>
# μ•”νΈν™” λ°©μ‹
<br><br>
## 1. λ€μΉ­ν‚¤ λ°©μ‹

> μ΄ λ€μΉ­ν‚¤λ¥Ό κ°€μ§€κ³  μμΌλ©΄ μ–΄λμ½μ΄λ“  μ •λ³΄λ¥Ό λ³µνΈν™”ν•  μ μλ‹¤.

μ•„λ¬΄ ν…μ¤νΈ νμΌμ„ μ•”νΈν™” ν•΄λ³΄μ

```bash
openssl enc -e -des3 -salt -in randtext.txt -out ciphertext.bin;
```

```bash
openssl enc -d -des3 -in ciphertext.bin -out randtext2.txt;
```

- -e λ” μ•”νΈν™”, -d λ” λ³µνΈν™” ν•λ‹¤λ” λ».
- des3 λΌλ” μ•”νΈν™”λ°©μ‹μ„ μ‚¬μ©ν•κ³ 
- in, out μ„ μ„¤μ •ν•΄μ¤€λ‹¤.

![image](https://s3.ap-northeast-2.amazonaws.com/donkeyadonkey-assets/img/1d28a716ba5c15461c44e306b8e9ec3f.png)

### κ²°λ΅ 

β†’ νΌμ μ‚¬μ©ν•λ©΄ μƒκ΄€μ—†λ‹¤. ν•μ§€λ§ λ„κµ°κ°€μ—κ² μ „λ‹¬ν•λ ¤λ©΄ κ²°κµ­ key κ°’μ„ μ¤μ•Όν•κ³ , κ·Έ key λ¥Ό λ‹¤λ¥Έλ°μ—λ‹¤ λΏλ ¤λ²„λ¦¬λ©΄ μ•„λ¬΄λ‚ λ³µνΈν™”ν•  μ μκ² λλ‹¤.
<br><br>
## 2. κ³µκ°ν‚¤ (public key) λ°©μ‹

> public key λ΅ μ•”νΈν™” + private key λ΅ λ³µνΈν™”
>
> μ–΄λ ν•μ½λ§ μ •λ³΄λ¥Ό λ³µνΈν™” ν•  μ μλ‹¤. λΉ„λ€μΉ­μ΄λ¨.

- λ‘κ°μ ν‚¤λ¥Ό μ‚¬μ©ν•λ‹¤.
- A ν‚¤λ΅ μ•”νΈν™” ν–λ‹¤λ©΄ B λΌλ” ν‚¤λ΅λ§ λ³µνΈν™”λ¥Ό ν•  μ μλ‹¤.
- μ΄λ• A λ” κ³µκ°ν‚¤ (public key), B λ” λΉ„λ°€ν‚¤ (private key, secret key)

### λΉ„λ°€ν‚¤λ΅ μ•”νΈν™” ν•κΈ°?

> νΉμ • λ€μƒ (μλ¥Ό λ“¤μ–΄ CA) μ΄ μ•”νΈν™”ν• μ •λ³΄λΌλ” κ²ƒμ„ ν™•μΈμ‹ν‚¤κΈ° μ„ν•΄ μλ„μ μΌλ΅ λΉ„λ°€ν‚¤λ¥Ό μ΄μ©ν•΄ μ•”νΈν™”ν•κΈ°λ„ ν•λ‹¤.

- μ›μΉ™μƒ κ³µκ°ν‚¤λ΅ μ •λ³΄λ¥Ό μ•”νΈν™” ν•λ‹¤. ν•μ§€λ§ λΉ„κ³µκ°ν‚¤λ΅ μ•”νΈν™”λ¥Ό ν•  μλ„ μλ‹¤. κ·Έλ¬λ©΄ κ³µκ°ν‚¤λ¥Ό μ΄μ©ν•΄μ„ μ΄ μ •λ³΄λ¥Ό λ³µνΈν™” ν•  μ μκ² λλ‹¤. κ·Έλ¬λ©΄ μ •λ³΄κ°€ μ‰½κ² λ…Έμ¶ λ  μ μμ–΄ λ³΄μΈλ‹¤. ν•μ§€λ§ μ΄κ²ƒμ€ μ •λ³΄λ¥Ό μ•”νΈν™”ν•λ” κ²ƒμ΄ λ©μ μ΄ μ•„λ‹λ‹¤. μ–΄λ–¤ κ³µκ°ν‚¤λ΅ λ³µνΈν™” ν•  μ μλ‹¤λ” κ²ƒμ μλ―Έλ” κ³§ μ΄μ— μƒμ‘ν•λ” λΉ„λ°€ν‚¤λ΅ μ•”νΈν™” λμ—λ‹¤λ” κ²ƒμ„ μλ―Έν•λ‹¤. μ΄μ™€ κ°™μ΄ νΉμ • λ€μƒμ΄ μ•”νΈν™” ν–λ‹¤λ” κ²ƒμ„ μ¦λ…ν•κΈ° μ„ν•΄ λΉ„λ°€ν‚¤λ΅ μ •λ³΄λ¥Ό μ•”νΈν™” ν•  μλ„ μλ‹¤.
- μ΄λ” CA κ°€ SSL μΈμ¦μ„λ¥Ό λΉ„λ°€ν‚¤λ¥Ό μ΄μ©ν•΄ μ•”νΈν™” ν• λ’¤ μ–΄λ–¤ λ€μƒμ΄ CA κ°€ κ³µκ°ν• κ³µκ°ν‚¤λ¥Ό μ‚¬μ©ν•΄ λ³µνΈν™” ν•¨μΌλ΅μ¨ μ΄ μΈμ¦μ„κ°€ κ·Έ CA μ— μν•΄ μ•”νΈν™”λ μΈμ¦μ„λΌλ” κ²ƒμ„ μ¦λ… ν•  μ μκ² λλ‹¤.
- μ–΄λ–¤ Key λ΅ μ•”νΈν™” ν•λ‹¤λ” κ²ƒμ€ κ³§, κ·Έ Key λ¥Ό μ‚¬μ©ν–λ‹¤λ” μ„λ… ν–λ‹¤λ” κ²ƒμ„ μλ―Έν•κ² λλ” λ“― ν•λ‹¤.

### κ³Όμ •

- private key μƒμ„±

	```bash
	openssl genrsa -out private.pem 1024;
	```

- private key λ¥Ό κ°€μ§€κ³  public key λ¥Ό μƒμ„±

	```bash
	openssl rsa -in private.pem -out public.pem -outform PEM -pubout;
	```

- public key λ΅ νμΌμ„ μ•”νΈν™”

	```bash
	openssl rsautl -encrypt -inkey public.pem -pubin -in file.txt -out file.ssl;
	```

- private key λ΅ νμΌμ„ λ³µνΈν™”

	```bash
	openssl rsautl -decrypt -inkey private.pem -in file.ssl -out decrypted.txt
	```
<br><br>
# SSL μΈμ¦μ„

- ν΄λΌμ΄μ–ΈνΈκ°€ μ ‘μ†ν• μ„λ²„κ°€ μλ„ν• κ·Έ μ„λ²„μΈκ°€?
- SSL ν†µμ‹ μ— μ‚¬μ©ν•  μ„λ²„μ κ³µκ°ν‚¤λ¥Ό ν΄λΌμ΄μ–ΈνΈμ—κ² μ κ³µ
<br><br>
## CA

Certificate authority, root Certificate

- μ–΄λ–¤ μ‚¬μ΄νΈκ°€ μ‹ λΆ°ν•  μ μλ” μ‚¬μ΄νΈμΈμ§€ λ³΄μ¦ν•λ” κΈ°κ΄€
- μ΄λ¬ν• κΈ°μ—…λ“¤μ€ λ§¤μ° μ—„κ²©ν•κ² μ„ μ •λλ‹¤.
- λΈλΌμ°μ €λ” μ•μ „ν•μ§€ ν™•μΈν•λ” CA μ λ¦¬μ¤νΈλ¥Ό κ°€μ§€κ³  μλ‹¤.
- μ΄λ¬ν• μ—…μ²΄μ—κ² λΉ„μ©μ„ μ§€λ¶ν•κ³  μΈμ¦μ„λ¥Ό κµ¬μ…ν•΄μ„ μ‚¬μ©ν•λ©΄ λλ‹¤.
- λ„λ©”μΈμ„ κµ¬λ§¤ν–μΌλ©΄ κ·Έ λ„λ©”μΈμ— λ€ν• μ†μ κ¶μ„ μ¦λ…ν•  μ μμ.
- λΈλΌμ°μ €κ°€ λ¨λ¥΄λ” μ‚¬μ„¤ μΈμ¦μ„λ¥Ό μ‚¬μ©ν•λ©΄ HTTPS λ¥Ό μ‚¬μ©ν•΄λ„ λΈλΌμ°μ €μ—μ„ μ•μ „ν•μ§€ μ•λ‹¤λ” ν‘μ‹λ¥Ό ν•  μλ„ μλ‹¤.
<br><br>
## SSL μΈμ¦μ„μ λ‚΄μ©

1. μ„λΉ„μ¤μ μ •λ³΄ ( CA κ°€ μ–΄λ””μΈμ§€, μ„λΉ„μ¤μ λ„λ©”μΈ...)
2. μ„λ²„μΈ΅ κ³µκ°ν‚¤

> μ—¬κΈ°μ„λ¶€ν„° ν΄λΌμ΄μ–ΈνΈλ” λΈλΌμ°μ €μ ν–‰λ™μ΄λΌκ³  μƒκ°ν•λ©΄ λλ‹¤.

### μ„λ²„κ°€ SSL μΈμ¦μ„λ¥Ό λ°κΈ‰λ°›κΈ° μ„ν•΄

1. μ„λ²„μ μ •λ³΄λ¥Ό CA μ— μ „λ‹¬

		μ„λ²„μ μ •λ³΄λ€: μ„λ²„μ κ³µκ°ν‚¤, κ°μΆ… μ„λ²„ μ •λ³΄

2. CA μ—μ„ μ΄ μ •λ³΄λ¥Ό λ‹΄μ€ SSL μΈμ¦μ„λ¥Ό λ°κΈ‰

3. SSL μΈμ¦μ„μ λ‚΄μ©μ„ μ•”νΈν™”ν•κΈ° μ„ν•΄ κ³µκ°ν‚¤, λΉ„λ°€ν‚¤λ¥Ό μƒμ„±

4. λΉ„λ°€ν‚¤λ΅ μΈμ¦μ„λ¥Ό μ•”νΈν™” (CA μ μ„λ…μ΄λΌκ³  λ³΄λ©΄ λ  λ“―.)
		- μ—¬κΈ°μ„ CA μ κ³µκ°ν‚¤λ¥Ό μ΄μ©ν•΄μ•Όλ§ μ΄ μΈμ¦μ„λ¥Ό λ³µνΈν™” ν•  μ μκ² λλ‹¤.

5. μ•”νΈν™”λ μΈμ¦μ„λ¥Ό μ„λ²„λ΅ μ „μ†΅ (μΈμ¦μ„κ°€ λ°κΈ‰λ¨)

### λΈλΌμ°μ €κ°€ νΉμ • μ„λ²„κ°€ μ‹ λΆ°ν•  μ μλ” μ„λ²„μΈμ§€ ν™•μΈν•λ” κ³Όμ •

1. ν΄λΌμ΄μ–ΈνΈκ°€ λΈλΌμ°μ €λ¥Ό μ‚¬μ©ν•΄ νΉμ • μ„λ²„μ— μ ‘μ†μ„ μ‹λ„ν•λ‹¤.
2. μ„λ²„λ” λΈλΌμ°μ €μ—κ² SSL μΈμ¦μ„λ¥Ό λ³΄λ‚Έλ‹¤.
3. λΈλΌμ°μ €λ” SSL μΈμ¦μ„λ¥Ό μ—¬λ¬ CA μ κ³µκ°ν‚¤λ¥Ό μ‚¬μ©ν•΄ μΈμ¦μ„λ¥Ό λ³µνΈν™” ν•λ‹¤.
4. νΉμ • CA μ κ³µκ°ν‚¤λ¥Ό μ‚¬μ©ν•΄ λ³µνΈν™”μ— μ„±κ³µν•λ‹¤λ©΄ κ·Έκ²ƒμ€ κ·Έ CA μ— μν•΄ λ°κΈ‰λ μΈμ¦μ„λΌλ” λ»μ΄λ‹¤.
5. λ”°λΌμ„ λΈλΌμ°μ €λ” μ΄ μ„λ²„μ— λ€ν•΄ μ‹ λΆ°ν•  μ μλ” μ‚¬μ΄νΈλΌλ” ν‘μ‹λ¥Ό ν•κ² λλ‹¤.

> CA κ°€ λΉ„λ°€ν‚¤λ¥Ό μ μ¶ν•μ§€ μ•λ” κ²ƒμ΄ μ¤‘μ”ν• μ΄μ μ΄λ‹¤.
>
> - λ§μ•½ CA κ°€ λΉ„λ°€ν‚¤λ¥Ό μ μ¶ν•κ² λλ©΄ λΈλΌμ°μ € μ…μ¥μ—μ„λ” νΉμ • SSL μΈμ¦μ„κ°€ CA κ°€ μ•”νΈν™”ν• μΈμ¦μ„κ°€ λ§λ”μ§€ ν™•μ‹ ν•  μ μ—†κ² λλ‹¤.
<br><br>
## μ„λΉ„μ¤ (μ„λ²„) μ κ³µκ°ν‚¤λ” μ–΄λ–¤ μ—­ν• ?

- λ°μ΄ν„°λ¥Ό μ „μ†΅ν•  λ• μ•”νΈν™”ν•κΈ° μ„ν•΄ κ³µκ°ν‚¤ λ°©μ‹μ„ μ‚¬μ©ν•λ©΄ λ†’μ€ μμ¤€μ λ³΄μ•μ„ ν•  μ μμ§€λ§ λ§μ€ μ»΄ν“¨ν… νμ›λ¥Ό μ”κµ¬ν•λ‹¤. λ§¤λ² μ •λ³΄λ¥Ό μ „λ‹¬ν•κΈ° μ„ν•΄ κ³µκ°ν‚¤ λ°©μ‹μΌλ΅ μ•”νΈν™”ν•λ” κ²ƒμ€ κ²½μ μ μ΄μ§€ λ»ν•λ‹¤.
- λ”°λΌμ„ μ •λ³΄λ¥Ό μ•”νΈν™”ν•λ” κ²ƒμ€ λ€μΉ­ν‚¤ λ°©μ‹μ„ μ‚¬μ©ν•λ‹¤.
- λ‹¨, μ΄ λ€μΉ­ν‚¤λ¥Ό μ•”νΈν™”ν•κΈ° μ„ν•΄ κ³µκ°ν‚¤ λ°©μ‹μ„ μ‚¬μ©ν•λ‹¤.
<br><br>
# HTTPS ν†µμ‹ μ„ μ„ν• TLS(SSL) Handshake

> μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈκ°€ μ•”νΈν™”λ ν†µμ‹ μ„ ν•λ” κ³Όμ •. TCP/IP λ„¤νΈμ›ν¬λ¥Ό μ‚¬μ©ν•λ” ν†µμ‹ μ— μ μ©λλ‹¤.
<br><br>
## 1. μ•…μ (handshake)

> ν•Έλ“μ…°μ΄ν¬λ” μ—¬λ¬κ°€μ§€ λ°©μ‹μ΄ μκ³ , λ€ν‘μ μΌλ΅ RSA λ°©μ‹, Diffie-Hellman λ°©μ‹μ΄ μλ‹¤κ³  ν•λ‹¤.
>
> μ•„λλ” RSA λ°©μ‹μ΄λ‹¤.

> μ•…μμ κ³Όμ •μ€ κ²°κ³Όμ μΌλ΅ μ•”νΈν™”λ λ°μ΄ν„° ν†µμ‹ μ„ μ„ν•΄ λ€μΉ­μ μΈ Session Key λ¥Ό λ§λ“λ” κ³Όμ •μ΄λ‹¤.
>
> - μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈκ°€ μ™Έλ¶€μ— λ…Έμ¶λμ§€μ•κ³  κ°μκ°€ κ°™μ€ Session Key κ°€μ§€κΈ° μ„ν•΄ μ•„λμ™€ κ°™μ€ κ³Όμ •μ„ κ±°μΉλ” κ²ƒμ΄λ‹¤.
> - λ€μΉ­μ μΈ Session Key λ¥Ό λ§λ“¤κΈ° μ„ν•΄ λΉ„λ€μΉ­μ  μ•”νΈν™” λ°©λ²• (κ³µκ° - λΉ„λ°€ν‚¤ λ°©μ‹) λ¥Ό μ‚¬μ©ν•λ‹¤κ³  μ΄ν•΄ν•μ.

![image](https://s3.ap-northeast-2.amazonaws.com/donkeyadonkey-assets/img/0c8452265ea781fa01b487dd7f6e3adc.jpeg)

### 1. Client Hello μ—μ„ μ „λ‹¬ν•λ” λ°μ΄ν„°

- ν΄λΌμ΄μ–ΈνΈ μΈ΅μ λλ¤ λ°μ΄ν„° (_**Client Random**_)
	- Master Secret μ„ μƒμ„±ν•λ” λ°μ— μ‚¬μ©ν•λ‹¤.
- ν΄λΌμ΄μ–ΈνΈκ°€ μ§€μ›ν•λ” μ•”νΈν™” λ°©μ‹
	- μ–΄λ–¤ μ•”νΈν™” μ•κ³ λ¦¬μ¦μ„ μ‚¬μ©ν•  μ μλ”κ°€?
- μ„Έμ… ID:
	- ν•Έλ“ μ‰μ΄ν¬μ— λ€ν• μ •λ³΄κ°€ λ‹΄κ²¨μλ” μ„Έμ… ID μ΄λ‹¤.
	- μ„λ²„λ” μ΄ μ„Έμ…μ„ ν™•μΈν•μ—¬ ν•Έλ“μ‰μ΄ν¬ ν• κΈ°λ΅μ΄ μλ‹¤λ©΄ κΈ°μ΅΄ μ„Έμ…μ„ ν™μ©ν•λ‹¤.
		- μ„Έμ…μ΄ μλ‹¤λ©΄ λ³µμ΅ν•κ² Session Key λ¥Ό κ³„μ‚°ν•λ” κ³Όμ •μ΄ ν•„μ” μ—†κ² μ§€.

### 2. Server Hello μ—μ„ μ „λ‹¬ν•λ” λ°μ΄ν„°

- μ„λ²„ μΈ΅μ λλ¤ λ°μ΄ν„° (_**Server Random**_)
	- Master Secret μ„ μƒμ„±ν•λ” λ°μ— μ‚¬μ©ν•λ‹¤.
- ν΄λΌμ΄μ–ΈνΈκ°€ μ§€μ›ν•λ” λ°©μ‹ μ¤‘ μ„λ²„κ°€ μ„ νƒν• μ•”νΈν™” λ°©μ‹ (_**Cipher Suite**_ λΌκ³  ν•λ” λ“―)
- μΈμ¦μ„

### 3. μ„λ²„κ°€ μ „λ‹¬ν• λ°μ΄ν„°λ¥Ό ν™•μΈ

- μ„λ²„κ°€ λ³΄λ‚Έ μΈμ¦μ„λ¥Ό λ¨Όμ € ν™•μΈν•λ‹¤.
	- ν΄λΌμ΄μ–ΈνΈκ°€ μ•κ³ μλ” CA μ— μν•΄ μΈμ¦λμ—λ”μ§€ μ—¬λ¬ CA μ κ³µκ°ν‚¤λ΅ λ³µνΈν™” ν•¨μΌλ΅μ¨ ν™•μΈ
	- μ΄ μΈμ¦μ„λ¥Ό λ³µνΈν™” ν•λ” λ°μ— μ„±κ³µν•λ©΄ **μ„λ²„μΈ΅μ΄ λ³΄λ‚Έ κ³µκ°ν‚¤** λ¥Ό μ–»μ„ μ μκ² λλ‹¤.
- λλ¤κ°’μΌλ΅ Premaster Secret μ„ μƒμ„± & μ•”νΈν™”
	- Master Secret μ„ κ³„μ‚°ν•λ” λ°μ— μ‚¬μ©ν•λ‹¤.
	- μ„λ²„μ κ³µκ°ν‚¤λ¥Ό μ‚¬μ©ν•΄ Premaster Secret μ„ μ•”νΈν™” ν•λ‹¤.
- μ•”νΈν™”λ Premaster Secret μ„ μ„λ²„λ΅ μ „μ†΅ (**ClientKeyExchange**)

### 4. ν΄λΌμ΄μ–ΈνΈμ—μ„ λ³΄λ‚Έ λ°μ΄ν„°λ¥Ό μ„λ²„κ°€ ν™•μΈ

- μ„λ²„κ°€ κ°€μ§„ λΉ„λ°€ν‚¤λ¥Ό μ‚¬μ©ν•΄ Premaster Secret μ„ λ³µνΈν™”
	- μ—¬κΈ°μ„ μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ λ¨λ‘κ°€ Premaster Secret μ„ κ°€μ§€κ³  μκ² λλ‹¤.
- Premaster Secret μ„ μ‚¬μ©ν•μ—¬ Master Secret λ¥Ό μƒμ„±ν•λ‹¤.
- Master Secret μ„ μ‚¬μ©ν•΄ Session Key λ¥Ό μƒμ„±ν•λ‹¤.
- μ΄ Session Key λ¥Ό μ‚¬μ©ν•΄ λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•μ—¬ μ£Όκ³ λ°›λ”λ‹¤.
- β€*Secretβ€μ€ κ·Έλ• κ·Έλ• λλ¤ν• κ°’μ„ λ§λ“¤κΈ° μ„ν•΄ μƒμ„±ν•λ” κ²ƒμ΄κ³ , β€*Keyβ€λ” μ‹¤μ  λ°μ΄ν„°λ¥Ό μ•”νΈν™” ν•λ”λ°μ— μ“°κΈ° μ„ν•΄ λ§λ“λ” κ²ƒμ΄λΌκ³  μ΄ν•΄ν•μ.

### 5. κ°μκ°€ Session Key λ¥Ό λ§λ“ λ‹¤.

- Premaster Secret, Client Random, Server Random μ„ μ‚¬μ©ν•΄ Master Secret μ„ λ§λ“¤κ³  Session Key λ¥Ό μƒμ„±ν•λ‹¤.
	- μ•”/λ³µνΈν™”μ— μ‚¬μ©λ  Session Key κ°€ μ™Έλ¶€μ— λ…Έμ¶λλ” κ³Όμ • μ—†μ΄ κ°κ°μ΄ κ°™μ€ Session Key λ¥Ό κ°€μ§€κ² λμ—λ‹¤.
- κ°μμ Session Key λ¥Ό κ°€μ§€κ³  β€finishedβ€λΌλ” λ©”μ‹μ§€λ¥Ό μ•”νΈν™”ν•μ—¬ λ³΄λ‚Έλ‹¤.(_**ChangeCipherSpec**_ λ©”μ‹μ§€λ¥Ό λ³΄λ‚Έλ‹¤κ³  ν‘ν„)
- μ„λ΅μ Session Key λ¥Ό κ°€μ§€κ³  λ°μ΄ν„°λ¥Ό μ•”/λ³µνΈν™” μν–‰.
- κ²°κ³Όμ μΌλ΅ μ΄ Session Key κ°€ λ€μΉ­ν‚¤μ μ—­ν• μ„ μν–‰ν•λ‹¤.

### Master Secret?

- 48 bytes μ κ³ μ •λ κΈΈμ΄λ¥Ό κ°€μ§€κ³  μλ‹¤.

- μ λ™μ μΈ ν¬κΈ°λ¥Ό κ°€μ§„ Premaster Secret μ„ μΌλ ¨μ κ³„μ‚°λ²•μ„ μ‚¬μ©ν•μ—¬ Master Secret μ„ κ³„μ‚°ν•  μ μλ‹¤.

	[RFC 5246 - The Transport Layer Security (TLS) Protocol Version 1.2](https://datatracker.ietf.org/doc/html/rfc5246#section-8.1)

- κ²°λ΅ : `(Premaster Secret, Client Random, Server Random) => Master Secret`

- μ΄ Master Secret μ„ μ΄μ©ν•μ—¬ Session Key λ¥Ό λ§λ“λ”λ°, μ΄λ” ν†µμ‹ μ— ν•„μ”ν• μ—¬λ¬κ°€μ§€ Key λ¥Ό μ§€μΉ­ν•λ‹¤κ³  ν•λ‹¤.

	[Differences between the terms "pre-master secret", "master secret", "private key", and "shared secret"?](https://crypto.stackexchange.com/questions/27131/differences-between-the-terms-pre-master-secret-master-secret-private-key)

### ν•κ³„

> μ„λ²„μΈ΅ Private Key λ¥Ό νƒμ·¨λ‹Ήν•λ©΄ Session Key λ¥Ό μ μ¶”ν•  μ μλ‹¤.
>
> - RSA λ°©μ‹μ„ μ‚¬μ©ν–μ„ λ•μ μ–κΈ°μ΄λ‹¤.
<br><br>
## 2. μ„Έμ…

> μƒμ„±ν• Session Key λ¥Ό κ°€μ§€κ³  μ•”νΈν™”ν•μ—¬ λ°μ΄ν„°λ¥Ό λ³΄λ‚΄κ³ , λ³µνΈν™”ν•μ—¬ λ°μ΄ν„°λ¥Ό ν™•μΈν•λ‹¤.
>
> μ΄ μ„Έμ…μ—μ„ HTTPS ν†µμ‹ μ΄ κ°€λ¥ν• κ²ƒμ΄λ‹¤.
<br><br>
## 3. μ„Έμ… μΆ…λ£

> λ°μ΄ν„° μ „μ†΅μ΄ λλ‚λ©΄ μ„λ΅μ—κ² ν†µμ‹ μ΄ λλ‚¬μμ„ μ•λ¦°λ‹¤. κ·Έλ¦¬κ³  Session Key λ¥Ό νκΈ°ν•λ‹¤.
>
> - λ”°λΌμ„ μ΄ Session Key λ¥Ό λ„κµ°κ°€ νƒμ·¨ν•λ‹¤κ³  ν•λ”λΌλ„ μ„Έμ…μ΄ λλ‚λ©΄ λ°μ΄ν„°λ¥Ό λ³Ό μ μ—†λ‹¤.
> - Session Key λ¥Ό νƒμ·¨ν•κ±°λ‚, μ„λ²„μΈ΅ Private Key λ¥Ό νƒμ·¨ν•λ”λΌλ„ μ΄λ―Έ λ°μ΄ν„° ν†µμ‹ μ΄ λλ‚¬λ‹¤λ©΄ μ•„λ¬΄ μλ―Έκ°€ μ—†κ² λλ‹¤.

### μ„Έμ…μ€ μ–Έμ λ¶€ν„° μ–Έμ κΉμ§€λ¥Ό λ§ν•λ”κ°€?

> μ„Έμ… ID λ΅ μ‹λ³„λλ” κ°™μ€ Master Secret μ„ μ‚¬μ©ν• μ—°κ²°λ“¤μ„ λ§ν•λ‹¤.
>
> - Handshake λ¥Ό μ”μ•½ν•μλ©΄ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ μ†ν†µν•κΈ° μ„ν•΄ λΉ„λ€μΉ­ μ•”νΈν™” μ „λµμ„ μ‚¬μ©ν•μ—¬ λ€μΉ­ ν‚¤λ¥Ό λ„μ¶ (_derive_ λΌκ³  λ³΄ν†µ ν‘ν„) ν•λ” κ³Όμ •μ„ μλ―Έν•λ‹¤.
>
> - Handshake λ” κ°μμ Random κ°’μ„ κµν™ν•μ—¬ Master Secret μ„ λ„μ¶ν•λ” β€full handshakeβ€κ°€ μκ³ , Session ID λ¥Ό μ‚¬μ©ν•μ—¬ μ΄μ „μ μ—°κ²°μ—μ„ μ‚¬μ©ν• Master Secret μ„ μ¬μ‚¬μ©ν•λ” λ°μ— ν•©μν•λ” β€abbreviated handshakeβ€ κ°€ μλ‹¤.
>
> 	  <aside>
> 	  π“ *abbreviated handshake λ¥Ό ν•λ”λ°μ— κ°μκ°€ ν•©μν•λ‹¤λ©΄, Session Key λ” κ°±μ‹ λλ‹¤. λ‹¤λ§ Master Secret μ€ κ°™μ€ κ²ƒμ„ μ“°λ” κ²ƒμ΄λ‹¤.*
>
> 	  </aside>
>
> - μ–΄λ–¤ handshake λ¥Ό ν•λ“  κ°™μ€ Master Secret μ„ μ‚¬μ©ν•λ” μ†ν†µμ΄λ©΄ ν•λ‚μ μ„Έμ…μΌλ΅ λ³Έλ‹¤.
>
> - μ΄λ” ν•λ‚μ μ„Έμ…μ—μ„ μ—¬λ¬ μ—°κ²°μ΄ μ΅΄μ¬ν•  μ μμμ„ μλ―Έν•λ‹¤.

### ν•λ‚μ Master Secret μ—μ„ μƒλ΅μ΄ Session Key λ” μ–΄λ–»κ² λ§λ“¤μ§€?

> μƒλ΅μ΄ μ—°κ²°μ„ μ„ν•΄μ„ abbreviated handshake λ¥Ό ν•λ”λ°μ— ν•©μν• κ²½μ°, Master Secret μ„ μ¬ν™μ©ν•λ‹¤.μ΄λ• μƒλ΅ μƒμ„±ν•  Session Key λ” μƒ μ—°κ²°μ μ²« λ©”μ‹μ§€μ—μ„ μ„λ΅κ°€ λ³΄λ‚΄λ” Client Random, Server Random μ„ μ‚¬μ©ν•μ—¬ λ‹¤μ‹ λ„μ¶ν•λ” κ²ƒμ΄λ‹¤. λ”°λΌμ„ Master Secret μ€ μ μ§€ν•λ”λΌλ„ μƒλ΅μ΄ Session Key(λ€μΉ­ν‚¤) λ¥Ό λ§λ“¤ μ μλ” κ²ƒμ΄λ‹¤.

[How long does an HTTPS symmetric key last](https://security.stackexchange.com/questions/55454/how-long-does-an-https-symmetric-key-last)

[How does server use session key after tls handshake?](https://security.stackexchange.com/questions/194723/how-does-server-use-session-key-after-tls-handshake)

### μ¶”κ°€

- Session resumption: λ‹¤λ¥Έ TCP μ—°κ²° μ„μ— μ΄μ „ TLS μ„Έμ…μ„ μ‚¬μ©ν•λ” κ²ƒ.
	- ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ μ΄μ „μ— μ ν¨ν• TLS μ„Έμ…μ΄ μμμ„ ν™•μΈν•κ³  μƒλ΅μ΄ TCP μ—°κ²°μ— μ΄μ „ TLS μ„Έμ…μ„ μ‚¬μ© (μ¬μ‹μ‘) ν•κΈ°λ΅ ν•©μν•λ” κ²ƒμ΄λ‹¤.
- Session renegotiation: κ°™μ€ TCP μ—°κ²° μ„μ— λ‹¤λ¥Έ TLS μ„Έμ…μ„ λ§Ίλ” κ²ƒ.
	- μ΄μ „κ³Ό λ‹¤λ¥Έ νλΌλ―Έν„° (μ–‘μΈ΅μ Random κ°’, premaster secret λ“±μΌλ΅ μ¶”μ •λ¨) λ¥Ό κµν™ν•μ—¬ μƒλ΅μ΄ handshake λ¥Ό ν•λ” κ²ƒ.
<br><br>
# μ°Έκ³  λ§ν¬

[What happens in a TLS handshake? | SSL handshake | Cloudflare](https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/)

[Differences between the terms "pre-master secret", "master secret", "private key", and "shared secret"?](https://crypto.stackexchange.com/questions/27131/differences-between-the-terms-pre-master-secret-master-secret-private-key)

[HTTPS - 2. HTTPSμ Ciphersuite, Handshake, Key derivation](https://dokydoky.tistory.com/463)

[HTTPSμ™€ SSL μΈμ¦μ„ - μƒν™μ½”λ”©](https://opentutorials.org/course/228/4894)

[μ „μ†΅ κ³„μΈµ λ³΄μ• - μ„ν‚¤λ°±κ³Ό, μ°λ¦¬ λ¨λ‘μ λ°±κ³Όμ‚¬μ „](https://ko.wikipedia.org/wiki/%EC%A0%84%EC%86%A1_%EA%B3%84%EC%B8%B5_%EB%B3%B4%EC%95%88)
